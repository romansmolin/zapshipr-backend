"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const app_1 = require("./app");
const client_1 = require("./db/client");
const auth_routes_1 = require("./modules/auth/routes/auth.routes");
const accounts_routes_1 = require("./modules/social/routes/accounts.routes");
const post_routes_1 = require("./modules/post/routes/post.routes");
const waitlist_routes_1 = require("./modules/waitlist/routes/waitlist.routes");
const user_routes_1 = require("./modules/user/routes/user.routes");
const workspace_routes_1 = require("./modules/workspace/routes/workspace.routes");
const inspirations_routes_1 = require("./modules/inspiration/routes/inspirations.routes");
const workspace_tags_routes_1 = require("./modules/inspiration/routes/workspace-tags.routes");
const error_handler_1 = require("./shared/http/error-handler");
const console_logger_1 = require("./shared/logger/console-logger");
const startServer = async () => {
    const app = (0, app_1.createApp)();
    const logger = new console_logger_1.ConsoleLogger();
    const authRoutes = (0, auth_routes_1.createAuthRouter)(logger, client_1.db);
    const accountsRoutes = (0, accounts_routes_1.createAccountsRouter)(logger, client_1.db);
    const postsRoutes = (0, post_routes_1.createPostsRouter)(logger, client_1.db);
    const waitlistRoutes = (0, waitlist_routes_1.createWaitlistRouter)(logger, client_1.db);
    const userRoutes = (0, user_routes_1.createUserRoutes)(logger, client_1.db);
    const workspaceRoutes = (0, workspace_routes_1.createWorkspaceRouter)(logger, client_1.db);
    const inspirationsRoutes = (0, inspirations_routes_1.createInspirationsRouter)(logger, client_1.db);
    const workspaceTagsRoutes = (0, workspace_tags_routes_1.createWorkspaceTagsRouter)(logger, client_1.db);
    app.use(authRoutes);
    app.use(accountsRoutes);
    app.use(postsRoutes);
    app.use(waitlistRoutes);
    app.use(userRoutes);
    app.use(workspaceRoutes);
    app.use(inspirationsRoutes);
    app.use(workspaceTagsRoutes);
    app.use((0, error_handler_1.createErrorHandler)(logger));
    const port = process.env.PORT || 4000;
    app.listen(port, () => {
        logger.info(`API server is running on port ${port}`);
    });
};
startServer().catch((error) => {
    console.error('Failed to start server:', error);
    process.exit(1);
});
